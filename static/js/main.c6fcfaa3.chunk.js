(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{113:function(e,t,a){e.exports=a(129)},124:function(e,t,a){},129:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(82),o=a.n(c),l=a(83),i=a(84),s=a(98),u=a(85),m=a(102),p={url:{API_URL:"https://db-truso-map-space.herokuapp.com"},app_id:{FACEBOOK_APPID:"383464965621720"}},d=a(36),b=r.a.createContext({});var f=function(e){var t=Object(n.useState)(null),a=Object(d.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)("explore"),i=Object(d.a)(l,2),s=i[0],u=i[1],m=Object(n.useState)(null),p=Object(d.a)(m,2),f=p[0],h=p[1],E={pointId:c,setPointId:o,mode:s,setMode:u,switchMode:function(){u("explore"===s?"edit":"explore")},data:f,setData:h};return r.a.createElement(b.Provider,{value:E},e.children)},h={isAuthenticated:!0,user:"5d2cd2dd1a88bd3129ed41cd",picture:"https://graph.facebook.com/10219128370309728/picture?type=large",jwToken:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjVkMmNkMmRkMWE4OGJkMzEyOWVkNDFjZCIsImlhdCI6MTU2MzY0ODQzMiwiZXhwIjoxNTYzNjU1NjMyfQ.5vQrd1hIBChW3GvPkzryUo8KwoRl6PtL6jiCLBD0jMo"},E=r.a.createContext({});var v=function(e){console.log("logedin",Object({NODE_ENV:"production",PUBLIC_URL:"/HackDay-Maps"}).REACT_APP_LOGEDIN);var t=Object(n.useState)(!!Object({NODE_ENV:"production",PUBLIC_URL:"/HackDay-Maps"}).REACT_APP_LOGEDIN),a=Object(d.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(Object({NODE_ENV:"production",PUBLIC_URL:"/HackDay-Maps"}).REACT_APP_LOGEDIN?h.user:null),i=Object(d.a)(l,2),s=i[0],u=i[1],m=Object(n.useState)(Object({NODE_ENV:"production",PUBLIC_URL:"/HackDay-Maps"}).REACT_APP_LOGEDIN?h.picture:null),p=Object(d.a)(m,2),b=p[0],f=p[1],v=Object(n.useState)(Object({NODE_ENV:"production",PUBLIC_URL:"/HackDay-Maps"}).REACT_APP_LOGEDIN?h.jwToken:null),O=Object(d.a)(v,2),j={isAuthenticated:c,setIsAuthenticated:o,user:s,setUser:u,jwToken:O[0],setJwToken:O[1],picture:b,setPicture:f};return r.a.createElement(E.Provider,{value:j},e.children)},O=p.url.API_URL;var j=function(e){var t=Object(n.useContext)(b),a=Object(n.useContext)(E);return"explore"===t.mode?"":r.a.createElement("div",null,r.a.createElement("form",{className:"container",onSubmit:function(e){e.preventDefault();var n=new URLSearchParams,r=!0,c=!1,o=void 0;try{for(var l,i=new FormData(e.target)[Symbol.iterator]();!(r=(l=i.next()).done);r=!0){var s=l.value;n.append(s[0],s[1])}}catch(u){c=!0,o=u}finally{try{r||null==i.return||i.return()}finally{if(c)throw o}}fetch(O+"/api/points",{method:"POST",headers:{Authorization:"Bearer "+a.jwToken,"Content-Type":"application/x-www-form-urlencoded"},body:n}).then(function(e){t.setData(null)})}},r.a.createElement("div",{className:"flexcontainer"},r.a.createElement("h3",null,"Add new location  "),r.a.createElement("input",{className:"d-none",readOnly:!0,type:"number",step:"any",name:"lon",id:"lon",value:e.lon}),r.a.createElement("input",{className:"d-none",readOnly:!0,type:"number",step:"any",name:"lat",id:"lat",value:e.lat})),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm"},r.a.createElement("label",{htmlFor:"name"},"Name:"),r.a.createElement("input",{required:!0,className:"form-control input-sm",placeholder:"place name",type:"text",name:"name",id:"name"})),r.a.createElement("div",{className:"col-sm"},r.a.createElement("label",{htmlFor:"description"},"Description:"),r.a.createElement("input",{className:"form-control input-sm",placeholder:"place decription",type:"text",name:"description",id:"description"})),r.a.createElement("div",{className:"col-sm"},r.a.createElement("label",{htmlFor:"type"},"Select type:"),r.a.createElement("select",{className:"form-control input-sm",id:"type",name:"type"},r.a.createElement("option",null,"camping"),r.a.createElement("option",null,"bonfire"),r.a.createElement("option",null,"view")))),r.a.createElement("div",{className:"flexcontainer"},r.a.createElement("button",{type:"submit",className:"btn btn-dark btn-bg"},"Add to the map"))))},y=a(86),w=a.n(y),N=a(87),x=a.n(N),I=a(88),C=a.n(I),P=a(15),g=(a(118),a(135)),k=a(97),A=a(101),_=a(96),D=a(134),L=a(136),S=a(74),U=a(61),R=a(137),T=a(79),M=p.url.API_URL,B={camping:w.a,bonfire:x.a,view:C.a},F=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={lon:17.862083241832444,lat:59.30184823106963},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=new D.a({source:new L.a({features:[]})}),a=new D.a({source:new L.a({features:[]})}),n=new g.a({target:this.refs.mapContainer,layers:[new A.a({source:new _.a}),t,a],view:new k.a({center:Object(P.d)([this.state.lon,this.state.lat]),zoom:11})});n.on("click",function(t){if("explore"===e.context.mode){var a=null;e.state.map.forEachFeatureAtPixel(t.pixel,function(e){a=e.get("id")||null});var n=null===a?"/location/":"/location/"+a;e.props.history.push(n)}else if("edit"===e.context.mode){var r=Object(P.h)(t.coordinate);e.setState({lon:r[0],lat:r[1]});var c=[],o=t.coordinate,l=new S.a({geometry:new U.a(o)});c.push(l),e.state.extraLayer.setSource(new L.a({features:c}))}}),this.setState({map:n,extraLayer:t,featuresLayer:a})}},{key:"componentDidUpdate",value:function(){var e=this;null===this.context.data&&(console.log(M+"/api/points"),fetch(M+"/api/points").then(function(e){return e.json()}).then(function(t){var a=[];t.forEach(function(e){var t=new R.a({opacity:1,scale:.05,src:B[e.type]}),n=new T.b({image:t}),r=Object(P.d)(e.localisation),c=new S.a({id:e._id,geometry:new U.a(r),name:e.name,description:e.description,rating:e.rating});c.setStyle(n),a.push(c)}),e.state.featuresLayer.setSource(new L.a({features:a})),e.context.setData(t)}).catch(function(e){return console.log(e)}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{ref:"mapContainer",id:"mapContainer"}),r.a.createElement(j,{lon:this.state.lon,lat:this.state.lat}))}}]),t}(r.a.Component);F.contextType=b;var z=F,G=a(100),J=p.url.API_URL;var V=function(e){var t=Object(n.useContext)(b),a=Object(n.useContext)(E),c=Object(n.useState)(""),o=Object(d.a)(c,2),l=o[0],i=o[1],s=Object(n.useState)(null),u=Object(d.a)(s,2),m=u[0],p=u[1];return Object(n.useEffect)(function(){if(i(""),t.data){var e=t.data.find(function(e){return e._id===t.pointId});p(e)}},[t.data,t.pointId]),m&&"edit"!==t.mode?r.a.createElement("div",{className:"flexcontainercolumn"},r.a.createElement("h1",null,m.name),r.a.createElement("p",null,m.description,r.a.createElement("br",null),"rating: ",m.rating),r.a.createElement("button",{type:"click",onClick:function(){fetch(J+"/api/points/"+t.pointId).then(function(e){return e.json()}).then(function(e){var t=e.map(function(e){return r.a.createElement("div",{className:"flexcontainercolumn"},r.a.createElement("br",null),r.a.createElement("h5",null,e.title),r.a.createElement("p",null," ",e.description," "),r.a.createElement("h5",null,"rated: ",e.rating))});i(t)})},className:"btn btn-dark btn-sm"},"Show reviews"),l,a.isAuthenticated?r.a.createElement("form",{className:"container",onSubmit:function(e){e.preventDefault();var n=new URLSearchParams,r=!0,c=!1,o=void 0;try{for(var l,i=new FormData(e.target)[Symbol.iterator]();!(r=(l=i.next()).done);r=!0){var s=l.value;n.append(s[0],s[1])}}catch(u){c=!0,o=u}finally{try{r||null==i.return||i.return()}finally{if(c)throw o}}fetch(J+"/api/points/"+t.pointId,{method:"POST",headers:{Authorization:"Bearer "+a.jwToken,"Content-Type":"application/x-www-form-urlencoded"},body:n,withCredentials:!0,credentials:"include"}).then(function(e){return e.json()}).then(function(e){p(Object(G.a)({},m,{rating:e.newRating}))})}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm"},r.a.createElement("label",{htmlFor:"title"},"Title:"),r.a.createElement("input",{className:"form-control input-sm",placeholder:"title",required:!0,name:"title",id:"title"})),r.a.createElement("div",{className:"col-sm"},r.a.createElement("label",{htmlFor:"description"},"Description:"),r.a.createElement("input",{className:"form-control input-sm",placeholder:"description",name:"description",id:"description"})),r.a.createElement("div",{className:"col-sm"},r.a.createElement("label",{htmlFor:"rating"},"Rating:"),r.a.createElement("input",{className:"form-control input-sm",placeholder:"1-10",required:!0,min:"1",max:"10",name:"rating",id:"rating",type:"number"}))),r.a.createElement("div",{className:"flexcontainer"},r.a.createElement("button",{type:"submit",className:" btn btn-dark btn-bg"},"Review"))):""):""};var H=function(e){var t=Object(n.useContext)(b);return Object(n.useEffect)(function(){var a=e.location.pathname.match(/[^\/]+$/)?e.location.pathname.match(/[^\/]+$/)[0]:null;t.pointId!==a&&t.setPointId(a)},[e.location.pathname]),r.a.createElement("div",null,r.a.createElement(z,{history:e.history}),r.a.createElement(V,null))},K=a(49);var Y=function(){var e=Object(n.useContext)(b),t=Object(n.useContext)(E),a="explore"===e.mode?"Edit map":"Explore";return r.a.createElement("div",{className:"App"},t.isAuthenticated?r.a.createElement("button",{id:"switch modes",onClick:e.switchMode},a):null,e.redirect,r.a.createElement(K.b,{path:"/",component:H}))},q=p.url.API_URL;var Q=function(e){var t=Object(n.useContext)(E),a=Object(n.useState)(null),c=Object(d.a)(a,2),o=c[0],l=c[1];return t.isAuthenticated||e.history.push("/"),Object(n.useEffect)(function(){fetch(q+"/api/profiles",{method:"GET",withCredentials:!0,credentials:"include",headers:{Authorization:"Bearer "+t.jwToken}}).then(function(e){return e.json()}).then(function(e){l(e)})},[]),r.a.createElement("div",{className:"Profile"},"Your Profile page ",r.a.createElement("br",null),o?"sucess":"no data")},W=a(71),Z=a(91),X=a.n(Z),$=a(92);function ee(){var e=Object($.a)(["\n  border-radius: 100%;\n  height: 3em;\n"]);return ee=function(){return e},e}var te=a(93).a.img(ee());p.url.API_URL;var ae=function(){var e=Object(n.useContext)(E),t=Object(n.useContext)(b),a=e.picture?r.a.createElement(te,{src:e.picture,alt:"Profile"}):"Profile";return console.log(p.app_id.FACEBOOK_APPID),r.a.createElement(W.a,{basename:"/HackDay-Maps"},r.a.createElement("nav",{className:"navbar navbar-dark bg-dark"},r.a.createElement("h1",{className:"text-light"},"Your Map Space"),e.isAuthenticated?r.a.createElement("button",{onClick:function(){e.setIsAuthenticated(!1),e.setUser(null),e.setJwToken(null),t.setMode("explore")},className:"button"},"Log out"):r.a.createElement(X.a,{appId:p.app_id.FACEBOOK_APPID,autoLoad:!0,fields:"name,email,picture",callback:function(e){console.log(e)}}),e.isAuthenticated?r.a.createElement(W.b,{to:"/profile"},a):""),r.a.createElement(K.d,null,r.a.createElement(K.b,{path:"/location",component:Y}),r.a.createElement(K.b,{exact:!0,path:"/"},r.a.createElement(K.a,{to:"/location"})),r.a.createElement(K.b,{path:"/profile",component:Q})))};a(124),a(125);a(126).config(),o.a.render(r.a.createElement(f,null,r.a.createElement(v,null,r.a.createElement(ae,null))),document.getElementById("root"))},86:function(e,t,a){e.exports=a.p+"static/media/039-tent.ebd03a54.svg"},87:function(e,t,a){e.exports=a.p+"static/media/010-bonfire.21b76057.svg"},88:function(e,t,a){e.exports=a.p+"static/media/009-binoculars.6b6a714c.svg"}},[[113,1,2]]]);
//# sourceMappingURL=main.c6fcfaa3.chunk.js.map